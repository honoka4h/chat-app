import{g as _,H as c,r as u,c as w,a as l,l as y,v as b,m as x,n as F,p as M,F as k,o as A,q as B}from"./CJ4QiOoU.js";import{u as C}from"./BxxLc4LK.js";const I=2*1024*1024,m=1024,f=1024,R=_({__name:"profile",async setup(D){let t,r;const p=C(),d=([t,r]=c(()=>u(p.username)),t=await t,r(),t),o=([t,r]=c(()=>u(p.nickname)),t=await t,r(),t),v=B(),n=u(null),g=a=>{const e=a.target;if(e.files&&e.files[0]){const s=e.files[0];if(!s.type.startsWith("image/")){alert("이미지 파일만 업로드할 수 있습니다."),n.value=null,e.value="";return}if(s.size>I){alert("파일 크기는 2MB 이하만 가능합니다."),n.value=null,e.value="";return}const i=new Image;i.onload=()=>{if(i.width>m||i.height>f){alert(`이미지 크기는 ${m}x${f} 이하만 가능합니다.`),n.value=null,e.value="";return}n.value=s},i.src=URL.createObjectURL(s)}},h=async()=>{const a=new FormData;a.append("username",d.value),a.append("nickname",o.value),n.value?a.append("file",n.value):a.append("file","default-avatar.png");try{const e=await fetch(`${v.public.apiBase}/api/users/update`,{method:"POST",body:a});alert("프로필이 업데이트되었습니다.")}catch{alert("프로필 업데이트에 실패했습니다.");return}};return(a,e)=>(A(),w(k,null,[e[2]||(e[2]=l("h1",null,"프로필 설정",-1)),l("form",{onSubmit:M(h,["prevent"])},[y(l("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>F(o)?o.value=s:null),type:"text",placeholder:"사용자 이름"},null,512),[[b,x(o)]]),l("input",{type:"file",accept:"image/*",onChange:g},null,32),e[1]||(e[1]=l("button",{type:"submit"}," 전송 ",-1))],32)],64))}});export{R as default};
