- name: Deploy Backend  
  uses: appleboy/ssh-action@v0.1.7  
  with:
    host: ${{ secrets.SERVER_HOST }}  
    username: ${{ secrets.SERVER_USER }}  
    key: ${{ secrets.SSH_PRIVATE_KEY }}  
    port: 22  
    script: |
      # 서버 파일 준비
      mkdir -p /var/www/chat-app/Backend

      # 로컬에서 Backend 폴더 전체 압축해서 서버로 보내기
      tar czf backend.tar.gz -C $GITHUB_WORKSPACE Backend
      scp -o StrictHostKeyChecking=no backend.tar.gz ${{ secrets.SERVER_USER }}@${{ secrets.SERVER_HOST }}:/var/www/chat-app/
      ssh -o StrictHostKeyChecking=no ${{ secrets.SERVER_USER }}@${{ secrets.SERVER_HOST }} << 'EOF'
        cd /var/www/chat-app
        tar xzf backend.tar.gz
        cd Backend
        npm install
        npm run build
        pm2 restart chat-app || pm2 start dist/main.js --name chat-app
        rm backend.tar.gz
      EOF
